@model Spark.ViewModels.CartProductViewModel
@inject Spark.Logic.CartActions cartActions

@{
    ViewBag.Title = "Cart";
    var currentCart = ViewData["currentCart"];
    var sessionId = ViewData["sessionId"].ToString();
    var quantity = cartActions.GetQuantity(sessionId);
}
@if (currentCart is not null )
{
    <p>@currentCart</p>
}
<div class="row" >
    <div class="col">
        <div class="row">
            <div class="col-md-8 mx-auto">
                 <div class="row" style="margin-top:25px;">
        <div class="col-md-8">
            @*each product*@
             <form method="post">
                                    @foreach(var m in Model.products)
                                                    {
                                var image = "~/images/" + m.product_image_path;
                                <div class="row">
                    <div class="col">
                        <div class="row">
                            <div class="col-md-2">
                                <img src="@image" alt="No image" class="img-fluid" width="60" asp-append-version="true" />
                            </div>
                            <div class="col-md-4">
                                <div class="row">
                                    <div class="col">
                                        <p class="justify-content-md-start">@m.ProductName</p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col">
                                        <p>₹@m.Price</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="row">
                                    <div class="col-md-8">
                                 @*change quantity button*@
							<div class="">                    
                                    @*<input type="text" id="QuantityIn{@m.ProductId}" value="Select">*@
                                    <select  class="form-control" id="{@m.ProductId}" name="{@m.ProductId}" onchange="ExtractValue()">
                                        @for(int num=1;num<=@m.Quantity;num++)
                                        {
                                            <option value="@num">@num</option>
                                        }
                                    </select>
                            </div>
                                    </div>
                                </div>
                                <br />       
                            </div>
                            <div class="col-md-2">
                                <div class="row">
                                    <div class="col">
                                       <button type="submit" class="btn btn-danger" >Remove</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                                </div>
                                }
                                <div class="row">
                                    <div class="col">
                                        <button type="submit" class="btn-primary btn">SUBMIT</button>
                                    </div>
                                </div>
                              </form>
                        @*each product end*@

            </div>          
            <div class="col-md-4">
               <div class="card">
                   <div class="card-body">
                       @*for the total, grand total and tax*@
                       Bye, universe!
                    </div>
               </div>
            </div>
        </div>
    </div>
            </div>
        </div>
    @section Scripts
    {
        <script> 
            function ExtractValue()
                    {
                            $("select").change(function(){
                        var id = $(this).attr("id");
                        var _value = document.getElementById(id).value;
                        document.getElementById("QuantityIn{"+id+"}").value=_value;
                        console.log(id);
                         console.log(_value);
                        });
                    }
        </script>
    }
</div>